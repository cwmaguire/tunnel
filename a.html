<!DOCTYPE html>
<html>

    <head>
        <script language="JavaScript">
            function log(object){
                var newDiv = document.createElement("div");
                newDiv.innerText = object.x1 + ", " +
                                   object.y1 + ", " +
                                   object.x2 + ", " +
                                   object.y2 + ", " +
                                   object.xOrY + ", " +
                                   object.colours;
                document.body.appendChild(newDiv);
            }

            function chain(times, fn, object){
                log(object);

                if(times > 0){
                    window.setTimeout(function(){chain(times - 1, fn, fn.call(null, object))}, 100);
                }
            }

            function onLoad(){
                chain(20, draw, {x1: 20,
                                 y1: 20,
                                 x2: 0,
                                 y2: 0,
                                 xOrY: "x",
                                 colours: ["#FF0000", "#00FF00", "#0000FF", "#FFF0F0"]});
            }

            function draw(object){
                return drawObject(change(object));
            }

            function change(object){
                object.colours.push(object.colours.shift()); // rotate the colours
                object.x1 = object.x2;
                object.y1 = object.y2;

                if(object.xOrY == "x"){
                    object.x2 = object.x1 + 20;
                    object.xOrY = "y";
                }else{
                    object.y2 = object.y1 + 20;
                    object.xOrY = "x";
                }
                return object;
            }

            function drawObject(obj){
                var canvas1 = document.getElementById("canvas1");
                var context1 = canvas1.getContext("2d");
                context1.fillStyle = "#FFFFFF";
                context1.fillRect(0, 0, 400, 400);
                context1.fill();
                context1.beginPath();
                context1.strokeStyle = obj.colours[0];
                context1.moveTo(obj.x1, obj.y1);
                context1.lineTo(obj.x2, obj.y2);
                context1.stroke();
                context1.closePath();
                return obj;
            }
        </script>
    </head>
    <body onload="onLoad()">
        <canvas id="canvas1" width="400" height="400" style="border:1px solid black;"></canvas>
    </body>
</html>